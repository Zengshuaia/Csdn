<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>@ViewData["Title"] - Layui</title>
    <link rel="stylesheet" href="~/lib/layui/css/layui.css">
    <style type="text/css">
        .layui-side, .layui-body, .layui-footer {
            transition: all 0.7s ease 0ms;
        }
    </style>
</head>
<body>
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <div class="layui-logo layui-hide-xs layui-bg-black">CsdnSystem</div>
            <!-- 头部区域（可配合layui 已有的水平导航） -->
            <ul class="layui-nav layui-layout-left">
                <!-- 移动端显示 -->
                <li class="layui-nav-item layui-show-xs-inline-block layui-hide-sm" lay-header-event="menuLeft">
                    <a href="javascript:;">
                        <i class="layui-icon layui-icon-spread-left" style=""></i>
                    </a>
                </li>

                <li class="layui-nav-item layui-hide-xs change">
                    @*左侧导航栏图标*@
                    <a href="javascript:;">
                        <i class="layui-icon layui-icon-shrink-right tog"></i>
                    </a>
                </li>
                <li class="layui-nav-item">
                    <a href="javascript:;">+新增</a>
                    <dl class="layui-nav-child">
                        <dd><a href="">咨询</a></dd>
                        <dd><a href="">图片</a></dd>
                        <dd><a href="">用户</a></dd>
                    </dl>
                </li>
            </ul>
            <ul class="layui-nav layui-layout-right">
                <li class="layui-nav-item layui-hide layui-show-md-inline-block">
                    <a href="javascript:;">
                        <img src="//tva1.sinaimg.cn/crop.0.0.118.118.180/5db11ff4gw1e77d3nqrv8j203b03cweg.jpg" class="layui-nav-img">
                        tester
                    </a>
                    <dl class="layui-nav-child">
                        <dd><a href="">Your Profile</a></dd>
                        <dd><a href="">Settings</a></dd>
                        <dd><a href="">Sign out</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item" lay-header-event="menuRight" lay-unselect>
                    <a href="javascript:;">
                        <i class="layui-icon layui-icon-more-vertical"></i>
                    </a>
                </li>
            </ul>
        </div>

        <div class="layui-side layui-bg-black">
            <div class="layui-side-scroll">
                <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
                <ul class="layui-nav layui-nav-tree" lay-filter="test">
                    <li class="layui-nav-item layui-nav-itemed">
                        <a href="javascript:;">主页</a>
                        <dl class="layui-nav-child">
                            <dd>
                                <a href="javascript:;" data-type="tabAdd" tab-name="学生列表A" tab-url="/Home/Index" tab-layid="99" class="site-demo-active">

                                    控制台
                                </a>
                            </dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">基本元素</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">图标字体</a></dd>
                            <dd><a href="javascript:;">表单元素</a></dd>
                            <dd><a href="javascript">按钮</a></dd>
                            <dd><a href="javascript:;">静态表格</a></dd>
                            <dd><a href="">超链接</a></dd>

                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">menu group 2</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">list 1</a></dd>
                            <dd><a href="javascript:;">list 2</a></dd>
                            <dd><a href="">超链接</a></dd>

                        </dl>
                    </li>

                    <li class="layui-nav-item"><a href="javascript:;">click menu item</a></li>
                    <li class="layui-nav-item"><a href="">the links</a></li>
                </ul>
            </div>
        </div>

        <div class="layui-body">
            <!-- 内容主体区域 -->
            <div class="layui-tab" lay-filter="demo" lay-allowclose="true">
                <ul class="layui-tab-title">
                    <li class="layui-this" lay-id="11">网站设置</li>
                    <li lay-id="22">用户管理</li>
                    <li lay-id="33">权限分配</li>
                    <li lay-id="44">商品管理</li>
                    <li lay-id="55">订单管理</li>
                </ul>
                <div class="layui-tab-content">
                    <div class="layui-tab-item layui-show">内容1</div>
                    <div class="layui-tab-item">内容2</div>
                </div>
            </div>
            <div style="padding: 15px;">内容主体区域。</div>

        </div>

        <div class="layui-footer">
            <!-- 底部固定区域 -->
            底部固定区域
        </div>
    </div>

    <script src="~/lib/layui/layui.js"></script>
    <script src="~/lib/jquery/dist/jquery.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            var flag = false;
            $(".change").click(function () {
                flag = !flag;
                if (flag) {
                    $(".layui-body,.layui-footer").css({ "margin-left": "-14.5em" })
                    $(".layui-side").css({ "margin-left": "-14.5em", "opacity": "0" })
                    $(".tog").removeClass("layui-icon-shrink-right")
                    $(".tog").addClass("layui-icon-spread-left");
                } else {
                    $(".layui-side,.layui-body,.layui-footer").css({ "margin-left": "0em", "opacity": "1" })
                    $(".tog").removeClass("layui-icon-spread-left")
                    $(".tog").addClass(" layui-icon-shrink-right");
                }
            });
        });
        //JS
        layui.use(['element', 'layer', 'util'], function () {
            var element = layui.element
                , layer = layui.layer
                , util = layui.util
                , $ = layui.$;

            var active = {
                tabAdd: function (name, url, layid) {
                    //新增一个Tab项
                    element.tabAdd('demo', {
                        title: name  //用于演示
                        , content: '<iframe id="iframeMain" style="width: 100%" ; height="100%" ; scrolling="no" frameborder="no" src="' + url + '"></iframe>'
                        , id: layid //实际使用一般是规定好的id，这里以时间戳模拟下
                    })
                }
                , tabDelete: function (layid) {
                    //删除指定Tab项
                    element.tabDelete('demo', layid); //删除：“商品管理”


                    othis.addClass('layui-btn-disabled');
                }
                , tabChange: function (layid) {
                    //切换到指定Tab项
                    element.tabChange('demo', layid); //切换到：用户管理
                }
            };

            $('.site-demo-active').on('click', function () {
                var dataid = $(this);
                var name = dataid.attr("tab-name");
                var url = dataid.attr("tab-url");
                var tab_layid = dataid.attr("tab-layid");
                if ($(".layui-tab-title li[lay-id]").length <= 0) { //1.1 初始状态：1个Tab页也没有打开
                    active.tabAdd(name, url, tab_layid); //打开tab页
                    active.tabChange(tab_layid)//转到该tab页
                } else { //1.2   判断该Tab页是否已打开
                    var isData = false; //初始化一个标志，为false说明未打开该tab项 为true则说明已有
                    $.each($(".layui-tab-title li[lay-id]"), function () {
                        //如果点击左侧菜单栏所传入的id 在右侧tab项中的lay-id属性可以找到，则说明该tab项已经打开
                        if ($(this).attr("lay-id") == tab_layid) {
                            isData = true;
                        }
                    })
                    if (isData == false) {
                        //标志为false 新增一个tab项
                        active.tabAdd(name, url, tab_layid); //1.2.1  该Tab页未打开，则打开该tab页
                    }
                    active.tabChange(tab_layid)//1.2.2 转到该tab页
                }
                FrameWH();  //计算ifram层的大小
            });
            function FrameWH() { //计算ifram层的大小
                var h = $(window).height() - 41 - 10 - 60 - 10 - 44 - 10;
                $("iframe").css("height", h + "px");
            }
            $(window).resize(function () {
                FrameWH();
            })
            ////Hash地址的定位
            //var layid = location.hash.replace(/^#test=/, '');
            //element.tabChange('/Home/Index', layid);

            //element.on('tab(test)', function (elem) {
            //    location.hash = 'test=' + $(this).attr('lay-id');
            //});

            //头部事件
            util.event('lay-header-event', {
                //左侧菜单事件
                menuLeft: function (othis) {
                    layer.msg('展开左侧菜单的操作', { icon: 0 });
                }
                , menuRight: function () {
                    layer.open({
                        type: 1
                        , content: '<div style="padding: 15px;">处理右侧面板的操作</div>'
                        , area: ['260px', '100%']
                        , offset: 'rt' //右上角
                        , anim: 5
                        , shadeClose: true
                    });
                }
            });

        });


    </script>
</body>
</html>